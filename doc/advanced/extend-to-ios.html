
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <title>Extend to iOS Â· GitBook</title>
        <meta charset="UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.1.1">
        
        
        
    
    <link rel="stylesheet" href="../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="extend-to-html5.html" />
    
    
    <link rel="prev" href="extend-to-android.html" />
    

    <link rel="stylesheet"  href="//g.alicdn.com/mtb/lab-zikuan/0.1.3/weex/weex_doc.css" >
    <!--     
    <link rel="stylesheet"  href="ali_addition/weex_doc.css" >
    -->
    
    <link rel="icon" type="image/x-icon" href="http://alibaba.github.io/weex/img/favicon.ico">

    <script src="//g.alicdn.com/mtb/lab-zikuan/0.1.3/weex/weex_doc.js"></script>
    <!-- 
    <script src="ali_addition/weex_doc.js"></script>
    -->    
    
    <link rel="stylesheet"  href="http://g.alicdn.com/mtb/lab-zikuan/0.1.3/weex/weex_doc.css" >    
    <link rel="icon" type="image/x-icon" href="http://alibaba.github.io/weex/img/favicon.ico">    

    </head>
    <body>
        
<div class="book">
    
    
<div class="weex-doc-header">
    <div class="top-bar">
        <div class="top-bar-title" onclick="location='http://alibaba.github.io/weex/index.html'" ></div>                        
        <div class="top-bar-left">
            <ul  class="menu" role="menubar" >
                <li role="menuitem">
                    <a href='http://alibaba.github.io/weex/demo.html'>Showcase</a>                            
                </li>
                <li role="menuitem" >
                    <a href="http://alibaba.github.io/weex/download.html">Download</a>
                </li>
            </ul>
        </div>
        <div class="top-bar-right">
            <ul class="menu">
                <li>
                    <a href="https://github.com/alibaba/weex">
                        <img class='github' src='//g.alicdn.com/mtb/lab-zikuan/0.1.1/weex/github.png' alt='github' >
                    </a>
                 </li>
                </li>
            </ul>                    
        </div>
    </div>        
</div>



            
    <div class="book-summary">
        
            
            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="../guide.html">
            
                <a href="../guide.html">
            
                    
                    Guide
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.1" data-path="../tutorial.html">
            
                <a href="../tutorial.html">
            
                    
                    Tutorial
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2" data-path="../syntax/main.html">
            
                <a href="../syntax/main.html">
            
                    
                    Syntax
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.2.1" data-path="../syntax/data-binding.html">
            
                <a href="../syntax/data-binding.html">
            
                    
                    Data Binding
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.2" data-path="../syntax/style-n-class.html">
            
                <a href="../syntax/style-n-class.html">
            
                    
                    Style and Class
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.3" data-path="../syntax/events.html">
            
                <a href="../syntax/events.html">
            
                    
                    Events
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.4" data-path="../syntax/display-logic.html">
            
                <a href="../syntax/display-logic.html">
            
                    
                    Display Logic Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.5" data-path="../syntax/render-logic.html">
            
                <a href="../syntax/render-logic.html">
            
                    
                    Render Logic Control
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.6" data-path="../syntax/composed-component.html">
            
                <a href="../syntax/composed-component.html">
            
                    
                    Composed Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.7" data-path="../syntax/id.html">
            
                <a href="../syntax/id.html">
            
                    
                    Find an Element
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.8" data-path="../syntax/comm.html">
            
                <a href="../syntax/comm.html">
            
                    
                    Communications
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.2.9" data-path="../syntax/config-n-data.html">
            
                <a href="../syntax/config-n-data.html">
            
                    
                    Page Config & Data
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.3" data-path="../how-to/main.html">
            
                <a href="../how-to/main.html">
            
                    
                    How-tos
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.3.1" data-path="../how-to/preview-in-browser.html">
            
                <a href="../how-to/preview-in-browser.html">
            
                    
                    Preview In Browser
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.2" data-path="../how-to/preview-in-playground-app.html">
            
                <a href="../how-to/preview-in-playground-app.html">
            
                    
                    Preview in Native
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.3" data-path="../how-to/customize-a-native-component.html">
            
                <a href="../how-to/customize-a-native-component.html">
            
                    
                    Customize a native Component
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.4" data-path="../how-to/cuszomize-native-apis.html">
            
                <a href="../how-to/cuszomize-native-apis.html">
            
                    
                    Customize native APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.5" data-path="../how-to/debug-with-html5.html">
            
                <a href="../how-to/debug-with-html5.html">
            
                    
                    Debug in html5 renderer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.6" data-path="../how-to/require-3rd-party-libs.html">
            
                <a href="../how-to/require-3rd-party-libs.html">
            
                    
                    Require 3rd Party Libs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.3.7" data-path="../how-to/transform-code-into-js-bundle.html">
            
                <a href="../how-to/transform-code-into-js-bundle.html">
            
                    
                    Transform Code Into JS Bundle
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.2.4" data-path="main.html">
            
                <a href="main.html">
            
                    
                    Advanced
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.2.4.1" data-path="how-it-works.html">
            
                <a href="how-it-works.html">
            
                    
                    How It Works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.2" data-path="how-data-binding-works.html">
            
                <a href="how-data-binding-works.html">
            
                    
                    How Data Binding Works
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.3" data-path="integrate-to-android.html">
            
                <a href="integrate-to-android.html">
            
                    
                    Integrate to Android
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.4" data-path="integrate-to-ios.html">
            
                <a href="integrate-to-ios.html">
            
                    
                    Integrate to iOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.5" data-path="integrate-to-html5.html">
            
                <a href="integrate-to-html5.html">
            
                    
                    Integrate to web
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.6" data-path="extend-to-android.html">
            
                <a href="extend-to-android.html">
            
                    
                    Extend to Android
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.2.4.7" data-path="extend-to-ios.html">
            
                <a href="extend-to-ios.html">
            
                    
                    Extend to iOS
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2.4.8" data-path="extend-to-html5.html">
            
                <a href="extend-to-html5.html">
            
                    
                    Extend to web
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3" data-path="../references/main.html">
            
                <a href="../references/main.html">
            
                    
                    References
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.1" data-path="../references/bootstrap.html">
            
                <a href="../references/bootstrap.html">
            
                    
                    Bootstrap
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.2" data-path="../references/component-defs.html">
            
                <a href="../references/component-defs.html">
            
                    
                    Component Definition
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.3" data-path="../references/api.html">
            
                <a href="../references/api.html">
            
                    
                    Instance APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4" data-path="../components/main.html">
            
                <a href="../components/main.html">
            
                    
                    Built-in Components
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.1" data-path="../references/common-attrs.html">
            
                <a href="../references/common-attrs.html">
            
                    
                    Common Attributes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2" data-path="../references/common-style.html">
            
                <a href="../references/common-style.html">
            
                    
                    Common Style
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.2.1" data-path="../references/text-style.html">
            
                <a href="../references/text-style.html">
            
                    
                    Text Style
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.2.2" data-path="../references/color-names.html">
            
                <a href="../references/color-names.html">
            
                    
                    Color
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4.3" data-path="../references/common-event.html">
            
                <a href="../references/common-event.html">
            
                    
                    Common Event
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.4" data-path="../components/special-element.html">
            
                <a href="../components/special-element.html">
            
                    
                    Special Element
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.5" data-path="../components/div.html">
            
                <a href="../components/div.html">
            
                    
                    div
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.6" data-path="../components/scroller.html">
            
                <a href="../components/scroller.html">
            
                    
                    scroller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.7" data-path="../components/list.html">
            
                <a href="../components/list.html">
            
                    
                    list
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.7.1" data-path="../components/cell.html">
            
                <a href="../components/cell.html">
            
                    
                    cell
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4.8" data-path="../components/text.html">
            
                <a href="../components/text.html">
            
                    
                    text
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.9" data-path="../components/image.html">
            
                <a href="../components/image.html">
            
                    
                    image
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.10" data-path="../components/input.html">
            
                <a href="../components/input.html">
            
                    
                    input
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.11" data-path="../components/switch.html">
            
                <a href="../components/switch.html">
            
                    
                    switch
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.12" data-path="../components/slider.html">
            
                <a href="../components/slider.html">
            
                    
                    slider
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.4.12.1" data-path="../components/indicator.html">
            
                <a href="../components/indicator.html">
            
                    
                    indicator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.4.13" data-path="../components/video.html">
            
                <a href="../components/video.html">
            
                    
                    video
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.14" data-path="../components/a.html">
            
                <a href="../components/a.html">
            
                    
                    a
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.15" data-path="../components/web.html">
            
                <a href="../components/web.html">
            
                    
                    web
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.16" data-path="../components/wxc-tabbar.html">
            
                <a href="../components/wxc-tabbar.html">
            
                    
                    wxc-tabbar
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.4.17" data-path="../components/wxc-navpage.html">
            
                <a href="../components/wxc-navpage.html">
            
                    
                    wxc-navpage
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.5" data-path="../modules/main.html">
            
                <a href="../modules/main.html">
            
                    
                    Built-in Modules
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.5.1" data-path="../modules/dom.html">
            
                <a href="../modules/dom.html">
            
                    
                    dom
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.2" data-path="../modules/stream.html">
            
                <a href="../modules/stream.html">
            
                    
                    stream
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.3" data-path="../modules/modal.html">
            
                <a href="../modules/modal.html">
            
                    
                    modal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.4" data-path="../modules/animation.html">
            
                <a href="../modules/animation.html">
            
                    
                    animation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.5" data-path="../modules/webview.html">
            
                <a href="../modules/webview.html">
            
                    
                    webview
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.5.6" data-path="../modules/navigator.html">
            
                <a href="../modules/navigator.html">
            
                    
                    navigator
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.3.6" >
            
                <span>
            
                    
                    Low-level Specs
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.3.6.1" data-path="../specs/js-bundle-format.html">
            
                <a href="../specs/js-bundle-format.html">
            
                    
                    JS Bundle Format
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.2" data-path="../specs/js-framework-apis.html">
            
                <a href="../specs/js-framework-apis.html">
            
                    
                    JS Framework APIs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.3.6.3" data-path="../specs/virtual-dom-apis.html">
            
                <a href="../specs/virtual-dom-apis.html">
            
                    
                    Virtual DOM APIs
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.4" >
            
                <span>
            
                    
                    Examples
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.4.1" data-path="../demo/hello-world.html">
            
                <a href="../demo/hello-world.html">
            
                    
                    Hello World
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.2" data-path="../demo/modal.html">
            
                <a href="../demo/modal.html">
            
                    
                    Modal
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.3" data-path="../demo/list.html">
            
                <a href="../demo/list.html">
            
                    
                    List
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.4" data-path="../demo/slider.html">
            
                <a href="../demo/slider.html">
            
                    
                    Slider
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.5" data-path="../demo/animation.html">
            
                <a href="../demo/animation.html">
            
                    
                    Animation
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4.6" >
            
                <a target="_blank" href="https://github.com/alibaba/weex/tree/dev/examples">
            
                    
                    More
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.5" >
            
                <span>
            
                    
                    Service & Tools
            
                </span>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="1.5.1" data-path="../tools/cli.html">
            
                <a href="../tools/cli.html">
            
                    
                    CLI
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.2" data-path="../tools/transformer.html">
            
                <a href="../tools/transformer.html">
            
                    
                    Transformer
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.3" data-path="../tools/playground-app.html">
            
                <a href="../tools/playground-app.html">
            
                    
                    Playground App
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5.4" data-path="../tools/how-to-debug.html">
            
                <a href="../tools/how-to-debug.html">
            
                    
                    Debug
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="1.6" data-path="../faq.html">
            
                <a href="../faq.html">
            
                    
                    FAQ
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Extend to iOS</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
                                <section class="normal markdown-section">
                                
                                <h2 id="extend-to-ios">Extend to iOS</h2>
<p><a href="https://github.com/weexteam/article/issues/17" class="weex-translate" target="_blank">cn</a></p>
<h3 id="module-extend">Module extend</h3>
<p>Weex SDK provides only rendering capabilities, rather than have other capabilities, such as network, picture, and URL redirection. If you want these features, you need to implement it.</p>
<p>For example: If you want to implement an address jumping function, you can achieve a Module following the steps below.</p>
<h4 id="step-to-customize-a-module">Step to customize a module</h4>
<ol>
<li>Module 
customized must implement WXModuleProtocol</li>
<li>A macro named <code>WX_EXPORT_METHOD</code> must be added, as it is the only way to be recognized by Weex. It takes arguments that specifies the method in module called by JavaScript code.</li>
<li>The weexInstance should be synthesized. Each module object is bind to a specific instance.</li>
<li>Module methods will be invoked in UI thread, so do not put time consuming operation there. If you want to  execute the whole module methods in other thread, please implement the method <code>- (NSThread *)targetExecuteThread</code> in protocol. In the way, tasks distributed to this module will be executed in targetExecuteThread. </li>
<li>Weex params can be String or Map.</li>
<li>Module supports to return results to Javascript in callback. This callback is type of <code>WXModuleCallback</code>, the params of which can be String or Map.</li>
</ol>
<pre><code class="lang-objective-c">
    @implementation WXEventModule
    @synthesize weexInstance;
       WX_EXPORT_METHOD(@selector(openURL:callback))

    - (void)openURL:(NSString *)url callback:(WXModuleCallback)callback
    {
        NSString *newURL = url;
        if ([url hasPrefix:@&quot;//&quot;]) {
            newURL = [NSString stringWithFormat:@&quot;http:%@&quot;, url];
        } else if (![url hasPrefix:@&quot;http&quot;]) {
           newURL = [NSURL URLWithString:url relativeToURL:weexInstance.scriptURL].absoluteString;
        }

        UIViewController *controller = [[WXDemoViewController alloc] init];
        ((WXDemoViewController *)controller).url = [NSURL URLWithString:newURL];

        [[weexInstance.viewController navigationController] pushViewController:controller animated:YES];
        callback(@{@&quot;result&quot;:@&quot;success&quot;});
    }

    @end
</code></pre>
<h4 id="register-the-module">Register the module</h4>
<p>You can register the customized module by calling the method <code>registerModule:withClass</code> in WXSDKEngine.</p>
<pre><code class="lang-objective-c">
      WXSDKEngine.h
      /**
         *  @abstract Registers a module for a given name
         *  @param name The module name to register
         *  @param clazz  The module class to register
        **/
        + (void)registerModule:(NSString *)name withClass:(Class)clazz;

        [WXSDKEngine registerModule:@&quot;event&quot; withClass:[WXEventModule class]];
</code></pre>
<h3 id="handler-extend">Handler extend</h3>
<p>Weex SDK doesn&apos;t have capabilitis, such as image download &#x3001;navigator operation&#xFF0C;please implement these protocols by yourself.</p>
<h4 id="wximgloaderprotocol">WXImgLoaderProtocol</h4>
<p><font color="gray">
Weex SDK has no image download capability, you need to implement <code>WXImgLoaderProtocol</code>. Refer to the following examples.</font></p>
<pre><code class="lang-objective-c">
    WXImageLoaderProtocol.h
    @protocol WXImgLoaderProtocol &lt;WXModuleProtocol&gt;

    /**
      * @abstract Creates a image download handler with a given URL
      * @param imageUrl The URL of the image to download
      * @param imageFrame  The frame of the image you want to set
      * @param options : The options to be used for this download
      * @param completedBlock : A block called once the download is completed.
        image : the image which has been download to local.
        error : the error which has happened in download.
        finished : a Boolean value indicating whether download action has finished.
     */
     -(id&lt;WXImageOperationProtocol&gt;)downloadImageWithURL:(NSString *)url imageFrame:(CGRect)imageFrame userInfo:(NSDictionary *)options completed:(void(^)(UIImage *image,  NSError *error, BOOL finished))completedBlock;
     @end
</code></pre>
<p>Implement above protocol as follows.</p>
<pre><code class="lang-objective-c">
    @implementation WXImgLoaderDefaultImpl
    #pragma mark -
    #pragma mark WXImgLoaderProtocol

    - (id&lt;WXImageOperationProtocol&gt;)downloadImageWithURL:(NSString *)url imageFrame:(CGRect)imageFrame userInfo:(NSDictionary *)userInfo completed:(void(^)(UIImage *image,  NSError *error, BOOL finished))completedBlock
    {
        if ([url hasPrefix:@&quot;//&quot;]) {
            url = [@&quot;http:&quot; stringByAppendingString:url];
        }
        return (id&lt;WXImageOperationProtocol&gt;)[[SDWebImageManager sharedManager] downloadImageWithURL:[NSURL URLWithString:url] options:0 progress:^(NSInteger receivedSize, NSInteger expectedSize) {     
        } completed:^(UIImage *image, NSError *error, SDImageCacheType cacheType, BOOL finished, NSURL *imageURL) {
        if (completedBlock) {
            completedBlock(image, error, finished);
        }
        }];
    }
    @end
</code></pre>
<h4 id="register-the-handler">Register the handler</h4>
<p>You can register the handler which implements the protocol by calling  <code>registerHandler:withProtocol</code> in WXSDKEngine.</p>
<pre><code class="lang-objective-c">
      WXSDKEngine.h
      /**
        * @abstract Registers a handler for a given handler instance and specific protocol
        * @param handler The handler instance to register
        * @param protocol The protocol to confirm
        */
       + (void)registerHandler:(id)handler withProtocol:(Protocol *)protocol;

       [WXSDKEngine registerHandler:[WXImgLoaderDefaultImpl new] withProtocol:@protocol(WXImgLoaderProtocol)];
</code></pre>
<h2 id="custom-native-components-for-ios">Custom Native Components for iOS</h2>
<h3 id="component-extend">Component extend</h3>
<p>There are a lot of native components ready to be used in the Weex SDK,  but users always have their own use cases. You might have written an awesome native UI widget in your previous work and just want to wrap up it and export to Weex. So we provide a way to enable developers to create their own custom fully-native components.</p>
<p>This guide will use the implementation of existing component <code>image</code> to show you how to build a native component. It will also assume that you are familiar with iOS programming.</p>
<h4 id="registration">Registration</h4>
<p>Defining a custom native component is simple. Just call <code>[WXSDKEngine registerComponent:withClass:]</code> with the component&apos;s tag name as first argument.</p>
<pre><code>[WXSDKEngine registerComponent:@&quot;image&quot; withClass:[WXImageComponent class]];
</code></pre><p>Then you can create a <code>WXImageComponent</code> class to represent the implementation of image component.</p>
<p>Now you can use <code>&lt;image&gt;</code> wherever you want in the template.</p>
<pre><code>&lt;image&gt;&lt;/image&gt;
</code></pre><h4 id="adding-properties">Adding Properties</h4>
<p>The next thing we can do is to extend some native properties to make the component more powerful. As an image, let&apos;s say we should have a <code>src</code> attribute as image&apos;s remote source and a <code>resize</code> attribute as image&apos;s resize mode(contain/cover/stretch).</p>
<pre><code>@interface WXImageComponent ()

@property (nonatomic, strong) NSString *imageSrc;
@property (nonatomic, assign) UIViewContentMode resizeMode;

@end
</code></pre><p>All of the styles, attributes and events will be passed to the component&apos;s initialization method, so here you can store the properties which you are interested in.</p>
<pre><code>@implementation WXImageComponent

- (instancetype)initWithRef:(NSString *)ref type:(NSString *)type styles:(NSDictionary *)styles attributes:(NSDictionary *)attributes events:(NSArray *)events weexInstance:(WXSDKInstance *)weexInstance
{
    if (self = [super initWithRef:ref type:type styles:styles attributes:attributes events:events weexInstance:weexInstance]) {
        _imageSrc = [WXConvert NSString:attributes[@&quot;src&quot;]];
        _resizeMode = [WXConvert UIViewContentMode:attributes[@&quot;resize&quot;]];
    }

    return self;
}

@end
</code></pre><p>The properties getted in the attributes are of <code>id</code> type, so we have to convert them to the type we want using a conversion function.  Basic conversion functions can be found in the <code>WXConvert</code> file,  or you can just add your own conversion function.</p>
<h4 id="hooking-render-life-cycle">Hooking Render Life Cycle</h4>
<p>A Native Component has a life cycle managed by Weex. Weex creates it, layout it, renders it and destroys it.</p>
<p>Weex offers component life cycle hooks that give you visibility into these key moments and the ability to act when they occur.</p>
<table>
<thead>
<tr>
<th style="text-align:center">method</th>
<th>description </th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">initWithRef:type:...</td>
<td>Initializes a new component using the specified  properties. </td>
</tr>
<tr>
<td style="text-align:center">layoutDidFinish</td>
<td>Called when the component has just laid out.</td>
</tr>
<tr>
<td style="text-align:center">loadView</td>
<td>Creates the view that the component manages.  </td>
</tr>
<tr>
<td style="text-align:center">viewWillLoad</td>
<td>Called before the load of component&apos;&#x80;&#x99;s view .  </td>
</tr>
<tr>
<td style="text-align:center">viewDidLoad</td>
<td>Called after the component&apos;&#x80;&#x99;s view is loaded and set.</td>
</tr>
<tr>
<td style="text-align:center">viewWillUnload</td>
<td>Called just before releasing the component&apos;&#x80;&#x99;s view.</td>
</tr>
<tr>
<td style="text-align:center">viewDidUnload</td>
<td>Called when the component&apos;&#x80;&#x99;s view is released.</td>
</tr>
<tr>
<td style="text-align:center">updateStyles:</td>
<td>Called when component&apos;s style are updated.</td>
</tr>
<tr>
<td style="text-align:center">updateAttributes:</td>
<td>Called when component&apos;s attributes are updated.</td>
</tr>
<tr>
<td style="text-align:center">addEvent:</td>
<td>Called when adding an event to the component.</td>
</tr>
<tr>
<td style="text-align:center">removeEvent:</td>
<td>Called when removing an event frome the component.</td>
</tr>
</tbody>
</table>
<p>As in the image component example, if we need to use our own image view, we can override the <code>loadView</code> method.</p>
<pre><code>- (UIView *)loadView
{
    return [[WXImageView alloc] init];
}
</code></pre><p>Now Weex will use <code>WXImageView</code> to render the <code>image</code> component.</p>
<p>As an image component, we will need to fetch the remote image and set it to the image view.  This can be done in <code>viewDidLoad</code> method when the view is created and loaded. <code>viewDidLoad</code> is also the best time to perform additional initialization for your view&#xFF0C; such as content mode changing.</p>
<pre><code>- (void)viewDidLoad
{
    UIImageView *imageView = (UIImageView *)self.view;
    imageView.contentMode = _resizeMode;
    imageView.userInteractionEnabled = YES;
    imageView.clipsToBounds = YES;
    imageView.exclusiveTouch = YES;

    // Do your image fetching and updating logic
}
</code></pre><p>If image&apos;s remote source can be changed, you can also hook the <code>updateAttributes:</code> method to perform your attributes changing logic. Component&apos;s view always has been loaded while <code>updateAttributes:</code> or <code>updateStyles:</code> is called.</p>
<pre><code>- (void)updateAttributes:(NSDictionary *)attributes
{
    if (attributes[@&quot;src&quot;]) {
        _imageSrc = [WXConvert NSString:attributes[@&quot;src&quot;]];
        // Do your image updating logic
    }

    if (attributes[@&quot;resize&quot;]) {
        _resizeMode = [WXConvert UIViewContentMode:attributes[@&quot;resize&quot;]];
        self.view.contentMode = _resizeMode;
    }
}
</code></pre><p>Maybe there is even more life cycle hooks you might need to consider, such as <code>layoutDidFinish</code> while layout computing is finished.  If you want to go deeper, check out the <code>WXComponent.h</code> file in the source code.</p>
<p>Now you can use <code>&lt;image&gt;</code> and its attributes wherever you want in the template.</p>
<pre><code>&lt;image style=&quot;your-custom-style&quot; src=&quot;image-remote-source&quot; resize=&quot;contain/cover/stretch&quot;&gt;&lt;/image&gt;
</code></pre>
                                
                                </section>
                            
                        </div>
                    </div>
                
            </div>

            
                
                <a href="extend-to-android.html" class="navigation navigation-prev " aria-label="Previous page: Extend to Android">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="extend-to-html5.html" class="navigation navigation-next " aria-label="Next page: Extend to web">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
        gitbook.page.hasChanged({"page":{"title":"Extend to iOS","level":"1.2.4.7","depth":3,"next":{"title":"Extend to web","level":"1.2.4.8","depth":3,"path":"advanced/extend-to-html5.md","ref":"advanced/extend-to-html5.md","articles":[]},"previous":{"title":"Extend to Android","level":"1.2.4.6","depth":3,"path":"advanced/extend-to-android.md","ref":"advanced/extend-to-android.md","articles":[]},"dir":"ltr"},"config":{"gitbook":"3.1.1","theme":"default","variables":{},"plugins":["theme-default"],"pluginsConfig":{"highlight":{},"search":{},"lunr":{"maxIndexSize":1000000},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"}},"file":{"path":"advanced/extend-to-ios.md","mtime":"2016-06-29T02:51:33.591Z","type":"markdown"},"gitbook":{"version":"3.1.1","time":"2016-06-29T03:33:23.535Z"},"basePath":"..","book":{"language":""}});
        setTimeout(function(){
           window._rePostionVersion()
        },100);
        });
    </script>
</div>

        
    <script src="../gitbook/gitbook.js"></script>
    <script src="../gitbook/theme.js"></script>
    
        
        <script src="../gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

